# Canvas 2.0 å¯¹é½è¾…åŠ©ç³»ç»Ÿå®ç°æ€»ç»“

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

æˆåŠŸä¸ºCanvas 2.0é¡¹ç›®æ·»åŠ äº†å®Œæ•´çš„å¯¹é½/æ•æ‰/ç½‘æ ¼/è¾…åŠ©çº¿/æ ‡å°º/å¯¹ç§°å·¥å…·ç³»ç»Ÿï¼Œå¤§å¹…æå‡äº†ä¸“ä¸šæ€§ã€ç²¾ç¡®æ’ç‰ˆå’Œå¸ƒå±€æ§åˆ¶èƒ½åŠ›ã€‚

## ğŸ“ æ–°å¢æ ¸å¿ƒç»„ä»¶

### 1. å¯¹é½è¾…åŠ©ç³»ç»Ÿ - `AlignAssistSystem.jsx`
- **ä½ç½®**: `src/components/AlignAssistSystem.jsx`
- **åŠŸèƒ½**: æä¾›ä¸“ä¸šçº§çš„å¯¹é½ã€åˆ†å¸ƒã€å¯¹ç§°æ“ä½œç•Œé¢
- **ç‰¹è‰²åŠŸèƒ½**:
  - **å¯¹é½æ“ä½œ**: å·¦å¯¹é½ã€å±…ä¸­å¯¹é½ã€å³å¯¹é½ã€é¡¶éƒ¨å¯¹é½ã€å‚ç›´å±…ä¸­ã€åº•éƒ¨å¯¹é½
  - **åˆ†å¸ƒæ“ä½œ**: æ°´å¹³å‡åŒ€åˆ†å¸ƒã€å‚ç›´å‡åŒ€åˆ†å¸ƒï¼ˆ3ä¸ªæˆ–ä»¥ä¸Šå¯¹è±¡ï¼‰
  - **å¯¹ç§°æ“ä½œ**: æ°´å¹³é•œåƒã€å‚ç›´é•œåƒã€å¾„å‘å¯¹ç§°ï¼ˆ4é‡æ—‹è½¬å¤åˆ¶ï¼‰
  - **è¾…åŠ©æ˜¾ç¤º**: ç½‘æ ¼ã€æ ‡å°ºã€è¾…åŠ©çº¿çš„å¯è§æ€§æ§åˆ¶
  - **æ•æ‰è®¾ç½®**: å¸é™„ç½‘æ ¼ã€å¸é™„å¯¹è±¡çš„å¼€å…³æ§åˆ¶
  - **å‚æ•°è°ƒæ•´**: ç½‘æ ¼å¤§å°ã€æ•æ‰å®¹å·®çš„æ»‘å—è°ƒèŠ‚

### 2. ç½‘æ ¼æ ‡å°ºè¦†ç›–å±‚ - `GridRulerOverlay.jsx`
- **ä½ç½®**: `src/components/GridRulerOverlay.jsx`
- **åŠŸèƒ½**: é«˜æ€§èƒ½çš„ç½‘æ ¼å’Œæ ‡å°ºæ¸²æŸ“ç³»ç»Ÿ
- **æŠ€æœ¯ç‰¹è‰²**:
  - **é«˜DPIæ”¯æŒ**: è‡ªåŠ¨é€‚é…è®¾å¤‡åƒç´ æ¯”ï¼Œç¡®ä¿æ¸…æ™°æ˜¾ç¤º
  - **åŠ¨æ€ç½‘æ ¼**: æ ¹æ®ç¼©æ”¾çº§åˆ«è‡ªåŠ¨è°ƒæ•´ç½‘æ ¼å¯†åº¦å’Œæ ‡å°ºåˆ»åº¦
  - **ä¸»æ¬¡ç½‘æ ¼**: æ¯5æ ¼ä¸€æ¡ç²—çº¿ï¼Œæä¾›æ¸…æ™°çš„å±‚æ¬¡ç»“æ„
  - **æ™ºèƒ½æ ‡å°º**: è‡ªåŠ¨è°ƒæ•´åˆ»åº¦é—´è·ï¼Œé¿å…é‡å æ˜¾ç¤º
  - **æ€§èƒ½ä¼˜åŒ–**: Canvas 2D APIç›´æ¥æ¸²æŸ“ï¼Œæ— DOMå¼€é”€

### 3. è¾…åŠ©çº¿ç®¡ç†å™¨ - `GuidelineManager.jsx`
- **ä½ç½®**: `src/components/GuidelineManager.jsx`
- **åŠŸèƒ½**: æ™ºèƒ½è¾…åŠ©çº¿åˆ›å»ºã€ç®¡ç†å’Œå¸é™„ç³»ç»Ÿ
- **äº¤äº’ç‰¹è‰²**:
  - **æ‹–æ‹½åˆ›å»º**: ä»æ ‡å°ºåŒºåŸŸæ‹–å‡ºåˆ›å»ºæ°´å¹³/å‚ç›´è¾…åŠ©çº¿
  - **æ‹–æ‹½è°ƒæ•´**: ç‚¹å‡»è¾…åŠ©çº¿æ‰‹æŸ„æ‹–æ‹½è°ƒæ•´ä½ç½®
  - **åŒå‡»åˆ é™¤**: åŒå‡»è¾…åŠ©çº¿å¿«é€Ÿåˆ é™¤
  - **æ™ºèƒ½å¸é™„**: å¯¹è±¡ç§»åŠ¨æ—¶è‡ªåŠ¨å¸é™„åˆ°è¾…åŠ©çº¿
  - **å¯è§†åŒ–åé¦ˆ**: åŠé€æ˜è™šçº¿æ˜¾ç¤ºï¼Œæ‹–æ‹½æ‰‹æŸ„æç¤º

### 4. æ™ºèƒ½æ•æ‰ç³»ç»Ÿ - `SmartSnapSystem.js`
- **ä½ç½®**: `src/utils/SmartSnapSystem.js`
- **åŠŸèƒ½**: é«˜çº§æ™ºèƒ½æ•æ‰å’Œå¯¹é½ç®—æ³•
- **æ ¸å¿ƒç®—æ³•**:
  - **ç½‘æ ¼å¸é™„**: å¯¹è±¡è¾¹ç•Œè‡ªåŠ¨å¯¹é½åˆ°ç½‘æ ¼ç‚¹
  - **å¯¹è±¡å¸é™„**: å¯¹è±¡é—´è¾¹ç¼˜ã€ä¸­å¿ƒç‚¹çš„æ™ºèƒ½å¯¹é½
  - **è¾…åŠ©çº¿å¸é™„**: ä¸ç”¨æˆ·å®šä¹‰è¾…åŠ©çº¿çš„ç²¾ç¡®å¯¹é½
  - **å®æ—¶åé¦ˆ**: å¸é™„æ—¶æ˜¾ç¤ºçº¢è‰²è™šçº¿æç¤º
  - **å¤šé‡åˆ¤æ–­**: åŒæ—¶æ£€æµ‹å¤šç§å¸é™„å¯èƒ½ï¼Œé€‰æ‹©æœ€è¿‘è·ç¦»

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯å®ç°

### å¯¹é½ç®—æ³•
```javascript
// ä»¥å±…ä¸­å¯¹é½ä¸ºä¾‹
case 'center':
  const centerX = bounds.reduce((sum, b) => sum + b.centerX, 0) / bounds.length;
  bounds.forEach(({ obj, width }) => {
    obj.set({ left: centerX - width / 2 });
  });
  break;
```

### åˆ†å¸ƒç®—æ³•
```javascript
// æ°´å¹³å‡åŒ€åˆ†å¸ƒ
bounds.sort((a, b) => a.centerX - b.centerX);
const totalWidth = bounds[bounds.length - 1].centerX - bounds[0].centerX;
const spacing = totalWidth / (bounds.length - 1);
bounds.forEach((bound, index) => {
  if (index > 0 && index < bounds.length - 1) {
    const newCenterX = bounds[0].centerX + spacing * index;
    bound.obj.set({ left: newCenterX - bound.width / 2 });
  }
});
```

### å¯¹ç§°æ“ä½œ
```javascript
// å¾„å‘å¯¹ç§° - 4é‡æ—‹è½¬å¤åˆ¶
for (let i = 1; i < 4; i++) {
  const newAngle = angle + (Math.PI * 2 * i) / 4;
  const newX = canvasCenter.x + Math.cos(newAngle) * distance;
  const newY = canvasCenter.y + Math.sin(newAngle) * distance;
  // åˆ›å»ºæ—‹è½¬å‰¯æœ¬...
}
```

### æ™ºèƒ½æ•æ‰æ£€æµ‹
```javascript
// å¯¹è±¡é—´å¸é™„æ£€æµ‹
const xAlignments = [
  { pos: otherBounds.left, type: 'left-left' },
  { pos: otherBounds.right, type: 'left-right' },
  { pos: otherBounds.centerX, type: 'center-center' }
];
```

## ğŸ¨ ç”¨æˆ·ç•Œé¢è®¾è®¡

### å·¥å…·æ æ–°å¢åˆ†ç»„
- **è¾…åŠ©å·¥å…·ç»„**: ç½‘æ ¼ã€æ ‡å°ºã€å¯¹é½å·¥å…·ã€å¯¹ç§°å·¥å…·ã€è¾…åŠ©çº¿ã€æ•æ‰å¯¹é½
- **å›¾æ ‡è®¾è®¡**: ä½¿ç”¨Lucide Reactå›¾æ ‡åº“ï¼Œä¿æŒUIä¸€è‡´æ€§
- **åˆ†ç»„é€»è¾‘**: æŒ‰åŠŸèƒ½ç±»å‹åˆ†ç»„ï¼Œä¾¿äºç”¨æˆ·å¿«é€Ÿæ‰¾åˆ°å·¥å…·

### è¾…åŠ©é¢æ¿ç•Œé¢
- **ç´§å‡‘å¸ƒå±€**: åœ¨æœ‰é™ç©ºé—´å†…æä¾›ä¸°å¯ŒåŠŸèƒ½
- **å®æ—¶åé¦ˆ**: æ˜¾ç¤ºå½“å‰é€‰ä¸­å¯¹è±¡æ•°é‡ï¼ŒåŠ¨æ€å¯ç”¨/ç¦ç”¨æŒ‰é’®
- **å¯è§†åŒ–æ§åˆ¶**: çœ¼ç›å›¾æ ‡åˆ‡æ¢æ˜¾ç¤º/éšè—çŠ¶æ€
- **å‚æ•°è°ƒèŠ‚**: æ»‘å—æ§åˆ¶ç½‘æ ¼å¤§å°å’Œæ•æ‰å®¹å·®

### çŠ¶æ€æŒ‡ç¤º
- **é€‰æ‹©æ•°é‡**: "å¯¹é½ (2 ä¸ªå¯¹è±¡)" å®æ—¶æ˜¾ç¤º
- **åŠŸèƒ½æç¤º**: æ¯ä¸ªæŒ‰é’®éƒ½æœ‰è¯¦ç»†çš„tooltipè¯´æ˜
- **ä½¿ç”¨æŒ‡å—**: é¢æ¿åº•éƒ¨æä¾›æ“ä½œæç¤º

## ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### æ¸²æŸ“æ€§èƒ½
- **Canvasç›´æ¥ç»˜åˆ¶**: ç½‘æ ¼å’Œæ ‡å°ºä½¿ç”¨Canvas 2D APIï¼Œé¿å…DOMæ“ä½œ
- **äº‹ä»¶èŠ‚æµ**: é¼ æ ‡ç§»åŠ¨äº‹ä»¶ä½¿ç”¨requestAnimationFrameä¼˜åŒ–
- **é€‰æ‹©æ€§æ›´æ–°**: åªåœ¨å¿…è¦æ—¶é‡æ–°æ¸²æŸ“è¾…åŠ©å…ƒç´ 

### è®¡ç®—ä¼˜åŒ–
- **è¾¹ç•Œç¼“å­˜**: é¢„è®¡ç®—å¯¹è±¡è¾¹ç•Œä¿¡æ¯ï¼Œé¿å…é‡å¤è®¡ç®—
- **è·ç¦»ä¼˜åŒ–**: ä½¿ç”¨å¿«é€Ÿè·ç¦»æ¯”è¾ƒï¼Œå‡å°‘Math.sqrtè°ƒç”¨
- **æ‰¹é‡æ“ä½œ**: åŒæ—¶å¤„ç†å¤šä¸ªå¯¹è±¡çš„å¯¹é½æ“ä½œ

### å†…å­˜ç®¡ç†
- **äº‹ä»¶æ¸…ç†**: ç»„ä»¶å¸è½½æ—¶æ­£ç¡®ç§»é™¤æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨
- **å¯¹è±¡æ± **: å¤ç”¨ä¸´æ—¶è®¡ç®—å¯¹è±¡ï¼Œå‡å°‘åƒåœ¾å›æ”¶
- **æ™ºèƒ½é”€æ¯**: SmartSnapSystemæä¾›destroyæ–¹æ³•æ¸…ç†èµ„æº

## ğŸ“ ä¸“ä¸šåŠŸèƒ½ç‰¹è‰²

### ç²¾ç¡®æ§åˆ¶
- **åƒç´ çº§ç²¾åº¦**: æ”¯æŒåƒç´ çº§çš„ç²¾ç¡®å®šä½å’Œå¯¹é½
- **è§’åº¦å¸é™„**: æ—‹è½¬æ—¶è‡ªåŠ¨å¸é™„åˆ°15åº¦å¢é‡
- **æ¯”ä¾‹å¸é™„**: ç¼©æ”¾æ—¶å¯å¸é™„åˆ°ç½‘æ ¼å°ºå¯¸

### è®¾è®¡å¸ˆå·¥ä½œæµ
- **å¿«é€Ÿå¯¹é½**: é€‰æ‹©å¤šä¸ªå¯¹è±¡ä¸€é”®å¯¹é½
- **å‡åŒ€åˆ†å¸ƒ**: è‡ªåŠ¨è®¡ç®—é—´è·å®ç°å®Œç¾åˆ†å¸ƒ
- **é•œåƒå¤åˆ¶**: å¿«é€Ÿåˆ›å»ºå¯¹ç§°è®¾è®¡

### å¸ƒå±€è¾…åŠ©
- **ç½‘æ ¼ç³»ç»Ÿ**: å¯è‡ªå®šä¹‰ç½‘æ ¼å¤§å°çš„ç²¾ç¡®å¸ƒå±€
- **æ ‡å°ºæµ‹é‡**: å®æ—¶æ˜¾ç¤ºå°ºå¯¸å’Œä½ç½®ä¿¡æ¯
- **è¾…åŠ©çº¿**: è‡ªå®šä¹‰å‚è€ƒçº¿è¾…åŠ©ç²¾ç¡®å®šä½

## ğŸ”„ é›†æˆæ¶æ„

### ç»„ä»¶å±‚æ¬¡
```
AICanvasToolFabric (ä¸»ç»„ä»¶)
â”œâ”€â”€ Toolbar (å·¥å…·æ  - æ–°å¢è¾…åŠ©å·¥å…·)
â”œâ”€â”€ FabricCanvas (ç”»å¸ƒ - é›†æˆè¾…åŠ©ç³»ç»Ÿ)
â”‚   â”œâ”€â”€ GridRulerOverlay (ç½‘æ ¼æ ‡å°ºè¦†ç›–å±‚)
â”‚   â”œâ”€â”€ GuidelineManager (è¾…åŠ©çº¿ç®¡ç†å™¨)
â”‚   â””â”€â”€ SmartSnapSystem (æ™ºèƒ½æ•æ‰ç³»ç»Ÿ)
â””â”€â”€ AlignAssistSystem (è¾…åŠ©é¢æ¿)
```

### çŠ¶æ€ç®¡ç†
- **assistSettings**: è¾…åŠ©ç³»ç»Ÿçš„æ‰€æœ‰è®¾ç½®çŠ¶æ€
- **guidelines**: ç”¨æˆ·åˆ›å»ºçš„è¾…åŠ©çº¿æ•°æ®
- **canvasScale/canvasPan**: ç”»å¸ƒå˜æ¢çŠ¶æ€åŒæ­¥

### äº‹ä»¶æµ
1. ç”¨æˆ·é€‰æ‹©è¾…åŠ©å·¥å…· â†’ æ˜¾ç¤ºè¾…åŠ©é¢æ¿
2. ç”¨æˆ·è°ƒæ•´è®¾ç½® â†’ æ›´æ–°assistSettingsçŠ¶æ€
3. çŠ¶æ€ä¼ é€’åˆ°FabricCanvas â†’ æ›´æ–°è¾…åŠ©ç³»ç»Ÿ
4. ç”¨æˆ·æ“ä½œå¯¹è±¡ â†’ è§¦å‘æ™ºèƒ½æ•æ‰
5. æ•æ‰ç»“æœåé¦ˆ â†’ æ˜¾ç¤ºå¸é™„çº¿æç¤º

## ğŸ“Š åŠŸèƒ½è¦†ç›–åº¦

### âœ… å·²å®ç°åŠŸèƒ½
- [x] ç½‘æ ¼æ˜¾ç¤ºå’Œè‡ªå®šä¹‰
- [x] æ ‡å°ºæ˜¾ç¤ºå’Œåˆ»åº¦
- [x] è¾…åŠ©çº¿åˆ›å»ºå’Œç®¡ç†
- [x] ç½‘æ ¼å¸é™„
- [x] å¯¹è±¡é—´å¸é™„
- [x] è¾…åŠ©çº¿å¸é™„
- [x] 6ç§å¯¹é½æ–¹å¼
- [x] æ°´å¹³å‚ç›´åˆ†å¸ƒ
- [x] é•œåƒå¯¹ç§°
- [x] å¾„å‘å¯¹ç§°
- [x] è§’åº¦å¸é™„
- [x] å®æ—¶å¸é™„åé¦ˆ

### ğŸ”„ è®¾è®¡ç‰¹è‰²
- **éç ´åæ€§**: æ‰€æœ‰æ“ä½œå¯æ’¤é”€ï¼Œä¸ç ´ååŸå§‹è®¾è®¡
- **å®æ—¶é¢„è§ˆ**: æ“ä½œè¿‡ç¨‹ä¸­æä¾›å®æ—¶è§†è§‰åé¦ˆ
- **æ™ºèƒ½è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«æœ€ä½³å¸é™„ç›®æ ‡
- **æ€§èƒ½ç¨³å®š**: å¤§é‡å¯¹è±¡æƒ…å†µä¸‹ä¿æŒæµç•…æ“ä½œ

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### UIè®¾è®¡
- **ç•Œé¢å¸ƒå±€**: ç²¾ç¡®å¯¹é½æŒ‰é’®ã€è¾“å…¥æ¡†ç­‰UIå…ƒç´ 
- **æ …æ ¼è®¾è®¡**: åŸºäºç½‘æ ¼çš„å“åº”å¼å¸ƒå±€è®¾è®¡
- **ç»„ä»¶å¯¹é½**: å¤šä¸ªç»„ä»¶çš„æ‰¹é‡å¯¹é½å’Œåˆ†å¸ƒ

### å›¾å½¢è®¾è®¡
- **Logoè®¾è®¡**: å‡ ä½•å›¾å½¢çš„ç²¾ç¡®å¯¹ç§°å’Œå¯¹é½
- **æ’ç”»åˆ›ä½œ**: å¤æ‚å›¾å½¢çš„ç²¾ç¡®å¸ƒå±€æ§åˆ¶
- **å›¾æ ‡è®¾è®¡**: åƒç´ å®Œç¾çš„å›¾æ ‡å¯¹é½

### ä¸“ä¸šåˆ¶å›¾
- **æŠ€æœ¯å›¾çº¸**: CADçº§åˆ«çš„ç²¾ç¡®å®šä½
- **æµç¨‹å›¾**: èŠ‚ç‚¹å’Œè¿çº¿çš„è§„èŒƒå¯¹é½
- **æ¶æ„å›¾**: å¤æ‚ç»“æ„çš„æ•´é½æ’å¸ƒ

é€šè¿‡è¿™ä¸ªå®Œæ•´çš„å¯¹é½è¾…åŠ©ç³»ç»Ÿï¼ŒCanvas 2.0ç°åœ¨å…·å¤‡äº†ä¸“ä¸šå›¾å½¢è®¾è®¡è½¯ä»¶çš„æ ¸å¿ƒè¾…åŠ©åŠŸèƒ½ï¼Œä¸ºç”¨æˆ·æä¾›äº†ç²¾ç¡®ã€é«˜æ•ˆã€ä¸“ä¸šçš„è®¾è®¡ä½“éªŒï¼ğŸ¨âœ¨

## ğŸ” æµ‹è¯•å»ºè®®

### åŠŸèƒ½æµ‹è¯•
1. **å¤šå¯¹è±¡å¯¹é½**: é€‰æ‹©2-10ä¸ªä¸åŒç±»å‹å¯¹è±¡æµ‹è¯•å„ç§å¯¹é½æ–¹å¼
2. **åˆ†å¸ƒåŠŸèƒ½**: æµ‹è¯•3ä¸ªä»¥ä¸Šå¯¹è±¡çš„å‡åŒ€åˆ†å¸ƒ
3. **å¯¹ç§°æ“ä½œ**: æµ‹è¯•é•œåƒå’Œå¾„å‘å¯¹ç§°çš„æ•ˆæœ
4. **å¸é™„ç²¾åº¦**: æµ‹è¯•ä¸åŒå®¹å·®ä¸‹çš„å¸é™„æ•ˆæœ
5. **æ€§èƒ½å‹åŠ›**: æµ‹è¯•å¤§é‡å¯¹è±¡æ—¶çš„æ“ä½œæµç•…æ€§

### äº¤äº’æµ‹è¯•
1. **è¾…åŠ©çº¿åˆ›å»º**: ä»æ ‡å°ºæ‹–æ‹½åˆ›å»ºè¾…åŠ©çº¿
2. **è¾…åŠ©çº¿è°ƒæ•´**: æ‹–æ‹½è°ƒæ•´ä½ç½®å’ŒåŒå‡»åˆ é™¤
3. **ç½‘æ ¼è®¾ç½®**: è°ƒæ•´ç½‘æ ¼å¤§å°å’Œæ˜¾ç¤ºåˆ‡æ¢
4. **å®æ—¶åé¦ˆ**: éªŒè¯å¸é™„çº¿å’Œæ“ä½œæç¤º

è¿™ä¸ªç³»ç»Ÿä¸ºCanvas 2.0æä¾›äº†ä¸“ä¸šçº§çš„ç²¾ç¡®æ§åˆ¶èƒ½åŠ›ï¼